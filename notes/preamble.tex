\usepackage{catchfilebetweentags}
\newcommand{\loadeqn}[1]{%
    \ExecuteMetaData[equations.tex]{eq#1}%
}
\newcommand{\loadfig}[1]{%
    \ExecuteMetaData[figures/figures.tex]{#1}%
}
\usepackage[margin=0.7in]{geometry}
\usepackage[parfill]{parskip}
\usepackage[backend=biber, bibencoding=utf8, style=ieee, backref=true]{biblatex}
\usepackage[hyperfootnotes=false,hyperindex=true]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{amssymb,amsfonts,amsthm} % math
\usepackage{mathtools} % coloneqq
% \usepackage{commath} % dif
\newcommand{\dif}{\operatorname{d}}


\usepackage{bm} % \bm 
\usepackage{physics} % \pdv
\usepackage{imakeidx} % index
\usepackage{etoc} % localtabelofcontents
\usepackage{tikz}
\usetikzlibrary{
    decorations.markings, % contour integral
    patterns,
    positioning,
    arrows
}
\usepackage{tikz-cd} % commutative diagrams
\usepackage{pgfplots}
\usepgfplotslibrary{patchplots}
\pgfplotsset{compat=1.15}

\usepackage{sepfootnotes}
\newfootnotes{a}

\usepackage{subcaption}
\DeclareCaptionFormat{subfig}{#1#2#3}
\DeclareCaptionSubType{figure}
\captionsetup[subfigure]{format=subfig,labelsep=space,labelformat=parens}


\newcommand{\newterm}[1]{\textit{#1}\index{#1}}
\newcommand{\Xk}{X_k}
\newcommand{\Xkone}{X_{k+1}}
\newcommand{\bx}{\bm{x}}
\newcommand{\bX}{\bm{X}}
\newcommand{\bxi}{\bm{x}_i}
\newcommand{\delx}{\bx - \bxi}
\newcommand{\by}{\bm{y}}
\newcommand{\bY}{\bm{Y}}
\newcommand{\byi}{\bm{y}_i}
\newcommand{\dely}{\by - \byi}
\newcommand{\zbx}{Z(\bx)}
\newcommand{\zbxi}{Z(\bxi)}
\newcommand{\bb}{\bm{\beta}}
\newcommand{\hzbx}{\hat{Z}(\bx)}
\NewDocumentCommand{\evalat}{sO{\big}mm}{%
  \IfBooleanTF{#1}
   {\mleft. #3 \mright|_{#4}}
   {#3#2|_{#4}}%
}


\makeindex


% other packages
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{xcolor}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linktoc=all,     %set to all if you want both sections and subsections linked
    linkcolor=blue,
}

\makeatletter
\def\thm@space@setup{%
  \thm@preskip=5pt
  \thm@postskip=\thm@preskip % or whatever, if you don't want them to be equal
}
\makeatother

% proper inline math display, adjust height for symbols like \sum
% \everymath{\displaystyle}

\theoremstyle{definition}
\newtheorem{example}{Example}[section]

% % define tags for math use..
% \theoremstyle{plain}% default
% \newtheorem{theorem}{Theorem}[section]
% \newtheorem{corollary}{Corollary}[theorem]


% \theoremstyle{remark}
% \newtheorem*{rem}{Remark}
% \newtheorem*{note}{Note}
% \newtheorem{case}{Case}

% Gives begin{solution} same formating as \begin{proof}
\usepackage{environ}

\NewEnviron{splitenv}
  {\begin{equation}
     \begin{split}
       \BODY
     \end{split}
   \end{equation}}

\usepackage{mdframed}
%--------------------------------
% Redefinition of `\newmdtheoremenv` for accepting a starred version
% \DeclareDocumentCommand\newmdtheoremenv{s O{} m o m o }{%
% \IfBooleanTF{#1}{%
%    \newtheorem*{#3}{#5}%
%  }{%
%  \ifboolexpr{ test {\IfNoValueTF {#4}} and test {\IfNoValueTF {#6}} }%
%     {\newtheorem{#3}{#5}}{%
%      \IfValueTF{#4}{\newtheorem{#3}[#4]{#5}}{}%
%      \IfValueTF{#6}{\newtheorem{#3}{#5}[#6]}{}%
%     }
%   }%
%   \BeforeBeginEnvironment{#3}{%
%      \begin{mdframed}[#2]}%
%   \AfterEndEnvironment{#3}{%
%      \end{mdframed}}%
% }
%--------------------------------
% theorem
% \mdfdefinestyle{theoremSty}{backgroundcolor=blue!10,skipabove=5pt,skipbelow=5pt}
% \mdfdefinestyle{propositionSty}{backgroundcolor=yellow!10,skipabove=5pt,skipbelow=5pt}
% \mdfdefinestyle{corollarySty}{backgroundcolor=yellow!10,skipabove=5pt,skipbelow=5pt}
% \mdfdefinestyle{lemmaSty}{backgroundcolor=yellow!10,skipabove=5pt,skipbelow=5pt}
% \mdfdefinestyle{proofSty}{backgroundcolor=white,skipabove=5pt,skipbelow=5pt,hidealllines=true}
% \mdfdefinestyle{definitionSty}{backgroundcolor=green!10,skipabove=5pt,skipbelow=5pt}

\usepackage[most]{tcolorbox}
\newtcbtheorem[number within=section]{definition}{Definition}{colback=green!10,fonttitle=\bfseries}{def}
\newtcbtheorem[number within=section]{theorem}{Theorem}{colback=blue!10,fonttitle=\bfseries}{theo}
\newtcbtheorem[number within=section]{lemma}{Lemma}{colback=yellow!10,fonttitle=\bfseries}{lem}
\newtcbtheorem[number within=section]{corollary}{Corollary}{colback=yellow!10,fonttitle=\bfseries}{cor}
% \newtcbtheorem[number within=section]{example}{Example}{colback=purple!5,colframe=blue!100!,fonttitle=\bfseries}{exa}
\newtcbtheorem[number within=section]{proposition}{Proposition}{colback=yellow!10,fonttitle=\bfseries}{prop}

\usepackage{tablefootnote} 
\makeatletter 
\AfterEndEnvironment{definition}{%
 \tfn@tablefootnoteprintout% 
 \gdef\tfn@fnt{0}% 
}
\AfterEndEnvironment{theorem}{%
 \tfn@tablefootnoteprintout% 
 \gdef\tfn@fnt{0}% 
}
\AfterEndEnvironment{lemma}{%
 \tfn@tablefootnoteprintout% 
 \gdef\tfn@fnt{0}% 
}
\AfterEndEnvironment{corollary}{%
 \tfn@tablefootnoteprintout% 
 \gdef\tfn@fnt{0}% 
}
% \AfterEndEnvironment{example}{%
%  \tfn@tablefootnoteprintout% 
%  \gdef\tfn@fnt{0}% 
% }
\AfterEndEnvironment{proposition}{%
 \tfn@tablefootnoteprintout% 
 \gdef\tfn@fnt{0}% 
}
\makeatother 

%running fraction with slash - requires math mode.
\newcommand*\rfrac[2]{{}^{#1}\!/_{#2}}
%shortcut to mathbb
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\I}{\mathbb{I}}
% color highlighting
\newcommand{\hilight}[1]{\colorbox{yellow}{#1}}

\newcommand{\icol}[1]{% inline column vector
  \left(\begin{smallmatrix}#1\end{smallmatrix}\right)%
}

\newcommand{\irow}[1]{% inline row vector
  \begin{bmatrix}#1\end{bmatrix}%
}

\interfootnotelinepenalty=10000


\newcommand{\iu}{\mathrm{i}\mkern1mu}
\newcommand{\prt}[2]{\partial #1 / \partial #2}

\usepackage{stmaryrd} %mapsfrom