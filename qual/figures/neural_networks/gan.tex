\begin{figure*}
	\tikzset{
		%Define standard arrow tip
		>=stealth',
		%Define style for boxes
		punkt/.style={
				rectangle,
				rounded corners,
				draw=black, very thick,
				text width=6.5em,
				minimum height=2em,
				text centered
			},
	}
	\begin{adjustbox}{width=\textwidth}
		\begin{tikzpicture}

			\node[] (z) {$\bm{z} \sim \operatorname{N}(0,I)$};
			\node[punkt, fill=sail, right=2em of z] (gen) {Generator};
			\node[below=of gen, inner sep=0pt] (pt7) {};
			\node[above=of gen] (x) {Real image \(\bm{x}\)};
			\node[punkt, fill=plum, right=5em of gen, yshift=2.5em] (discr) {Discriminator};
			\node[above=of discr, inner sep=0pt] (pt8) {};
			\node[punkt, fill=snowymint, right=of discr] (loss) {Loss};
			\node[right=of loss, inner sep=0pt] (pt4) {};
			\node[above=3.85em of pt4, inner sep=0pt] (pt5) {};
			\node[below=6.2em of pt4, inner sep=0pt] (pt6) {};

			\node[right=3em of x, circle, fill, inner sep=0.15em] (pt1) {};
			\node[right=2.5em of gen, circle, fill, inner sep=0.15em] (pt2) {};
			\draw[dashed, thick] (pt1) edge[bend right] (pt2);
			\node[circle, draw, thick, fill=white, inner sep=0.15em] at ([xshift=-0.6em, yshift=3em]pt2.north) (pt3) {};

			\draw[-stealth, thick] (z) -- (gen);
			\draw[-stealth, thick] (pt3) -- (discr.west);
			\draw[-stealth, thick] (discr) -- (loss);
			\draw[-stealth, thick] (gen) -- (pt2);
			\draw[-stealth, thick] (x) -- (pt1);

			\draw[dashed, thick, -stealth] (loss) -- (pt4) -- (pt5) -- node[above] {\(\mathbb{E} [\log D(\bm{x})] + \\ \mathbb{E} [\log(1 - D(G(\bm{z})))]\)} (pt8) -- (discr.north);
			\draw[dashed, thick, -stealth] (loss) -- (pt4) -- (pt6) -- node[above] {\(\mathbb{E} [\log(1 - D(G(\bm{z})))]\)} (pt7) -- (gen.south);


		\end{tikzpicture}
	\end{adjustbox}
	\caption{Schematic diagram for Generative Adversarial Network}\label{fig:gan}

\end{figure*}
